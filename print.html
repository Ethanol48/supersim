<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Supersim</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="introduction.html">Introduction</a></li><li class="chapter-item expanded affix "><li class="part-title">Getting Started</li><li class="chapter-item expanded "><a href="getting-started/installation.html"><strong aria-hidden="true">1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="getting-started/first-steps.html"><strong aria-hidden="true">2.</strong> First steps</a></li><li class="chapter-item expanded affix "><li class="part-title">CLI Reference</li><li class="chapter-item expanded "><a href="reference/supersim.html"><strong aria-hidden="true">3.</strong> supersim</a></li><li class="chapter-item expanded "><a href="reference/supersim-fork.html"><strong aria-hidden="true">4.</strong> supersim fork</a></li><li class="chapter-item expanded affix "><li class="part-title">Chain Environment</li><li class="chapter-item expanded "><a href="chain-environment/contracts/index.html"><strong aria-hidden="true">5.</strong> Included contracts</a></li><li class="chapter-item expanded "><a href="chain-environment/network-details/index.html"><strong aria-hidden="true">6.</strong> Network details & contract addresses</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="chain-environment/network-details/op-chain-a.html"><strong aria-hidden="true">6.1.</strong> OPChainA</a></li><li class="chapter-item expanded "><a href="chain-environment/network-details/op-chain-b.html"><strong aria-hidden="true">6.2.</strong> OPChainB</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Guides</li><li class="chapter-item expanded "><a href="guides/deposit-transactions.html"><strong aria-hidden="true">7.</strong> Sending deposit transactions</a></li><li class="chapter-item expanded "><a href="guides/interop/index.html"><strong aria-hidden="true">8.</strong> Interoperability</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="guides/interop/interop-identifiers.html"><strong aria-hidden="true">8.1.</strong> Fetching identifiers for interop messages</a></li><li class="chapter-item expanded "><a href="guides/interop/calling-destination-contract.html"><strong aria-hidden="true">8.2.</strong> Calling contract on other chain</a></li><li class="chapter-item expanded "><a href="guides/interop/bridging-superchainweth.html"><strong aria-hidden="true">8.3.</strong> Bridging SuperchainWETH</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Examples</li><li class="chapter-item expanded "><a href="examples/cross-chain-tictactoe.html"><strong aria-hidden="true">9.</strong> Cross-chain tic-tac-toe</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Supersim</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>Supersim is a lightweight tool to simulate the Superchain (with a single L1 and multiple OP-Stack L2s).</p>
<p>Run multiple local nodes with one command, and coordinate message passing between these chains.</p>
<p>It does not require a complicated devnet setup and is run using cli commands with configuration options that fall back to sensible defaults if they are not specified. Each chain is an instance of <a href="https://book.getfoundry.sh/reference/anvil/">anvil</a>, though future versions may support other local testing tools.</p>
<h2 id="features"><a class="header" href="#features">Features</a></h2>
<ul>
<li>spin up multiple anvil nodes</li>
<li>predeployed OP Stack contracts and useful mock contracts (ERC20)</li>
<li>fork multiple remote chains (fork the entire Superchain)</li>
<li>simulate L1 &lt;&gt; L2 message passing (deposits)</li>
<li>simulate L2 &lt;&gt; L2 message passing (interoperability) and auto-relayer</li>
<li>(<strong>Coming soon</strong>) Withdrawals</li>
<li>(<strong>Coming soon</strong>) ERC-4337 account abstraction services (bundlers / paymasters / wallet implementation)</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="installation"><a class="header" href="#installation">Installation</a></h1>
<h2 id="1-prerequisites-foundry"><a class="header" href="#1-prerequisites-foundry">1. Prerequisites: <code>foundry</code></a></h2>
<p><code>supersim</code> requires <code>anvil</code> to be installed.</p>
<p>Follow the guide <a href="https://book.getfoundry.sh/getting-started/installation">here</a> to install the Foundry toolchain.</p>
<h2 id="2-install-supersim"><a class="header" href="#2-install-supersim">2. Install <code>supersim</code></a></h2>
<h3 id="precompiled-binaries"><a class="header" href="#precompiled-binaries">Precompiled Binaries</a></h3>
<p>Download the executable for your platform from the <a href="https://github.com/ethereum-optimism/supersim/releases">GitHub releases page</a>.</p>
<h3 id="homebrew-os-x-linux"><a class="header" href="#homebrew-os-x-linux">Homebrew (OS X, Linux)</a></h3>
<p><em>Coming soon</em></p>
<h2 id="3-start-supersim-in-vanilla-mode"><a class="header" href="#3-start-supersim-in-vanilla-mode">3. Start <code>supersim</code> in vanilla mode</a></h2>
<pre><code class="language-sh">supersim
</code></pre>
<p>Vanilla mode will start 3 chains, with the OP Stack contracts already deployed.</p>
<ul>
<li>(1) L1 Chain
<ul>
<li>Chain 900</li>
</ul>
</li>
<li>(2) L2 Chains
<ul>
<li>Chain 901</li>
<li>Chain 902</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="first-steps"><a class="header" href="#first-steps">First steps</a></h1>
<p><code>supersim</code> allows testing multichain features <strong>locally</strong>. Previously, testing multichain features required complex docker setups or using a testnet.</p>
<p>To see it in practice, let's first try sending some ETH from the L1 to the L2.</p>
<h2 id="deposit-eth-from-the-l1-into-the-l2-l1-to-l2-message-passing"><a class="header" href="#deposit-eth-from-the-l1-into-the-l2-l1-to-l2-message-passing">Deposit ETH from the L1 into the L2 (L1 to L2 message passing)</a></h2>
<h3 id="1-call-bridgeeth-function-on-the-l1standardbridgeproxy-contract-on-the-l1-chain-900"><a class="header" href="#1-call-bridgeeth-function-on-the-l1standardbridgeproxy-contract-on-the-l1-chain-900">1. Call <code>bridgeETH</code> function on the <code>L1StandardBridgeProxy</code> contract on the L1 (chain 900)</a></h3>
<p>Initiate a bridge transaction on the L1:</p>
<pre><code class="language-sh">cast send 0xa01ae68902e205B420FD164435F299E07b0C778b "bridgeETH(uint32 _minGasLimit, bytes calldata _extraData)" 50000 0x --value 0.1ether --rpc-url http://127.0.0.1:8545 --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80
</code></pre>
<h3 id="2-check-the-balance-on-the-l2-chain-901"><a class="header" href="#2-check-the-balance-on-the-l2-chain-901">2. Check the balance on the L2 (chain 901)</a></h3>
<p>Verify that the ETH balance of the sender has increased on the L2:</p>
<pre><code class="language-sh">cast balance 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 --rpc-url http://127.0.0.1:9545
</code></pre>
<p>Now that you know how to pass messages from the L1 to the L2, let's try a sending an L2 to L2 message!</p>
<h2 id="send-an-interoperable-superchainerc20-token-from-chain-901-to-902-l2-to-l2-message-passing"><a class="header" href="#send-an-interoperable-superchainerc20-token-from-chain-901-to-902-l2-to-l2-message-passing">Send an interoperable SuperchainERC20 token from chain 901 to 902 (L2 to L2 message passing)</a></h2>
<p>In a typical L2 to L2 cross-chain transfer, two transactions are required:</p>
<ol>
<li>Send transaction on the source chain – This initiates the token transfer on Chain 901.</li>
<li>Relay message transaction on the destination chain – This relays the transfer details to Chain 902.</li>
</ol>
<p>To simplify this process, you can use the <code>--interop.autorelay</code> flag. This flag automatically triggers the relay message transaction once the initial send transaction is completed on the source chain, improving the developer experience by removing the need to manually send the relay message.</p>
<h3 id="1-start-supersim-with-the-autorelayer-enabled"><a class="header" href="#1-start-supersim-with-the-autorelayer-enabled">1. Start <code>supersim</code> with the autorelayer enabled</a></h3>
<pre><code>supersim --interop.autorelay 
</code></pre>
<h3 id="2-mint-tokens-to-transfer-on-chain-901"><a class="header" href="#2-mint-tokens-to-transfer-on-chain-901">2. Mint tokens to transfer on chain 901</a></h3>
<p>Run the following command to mint 1000 tokens to the recipient address:</p>
<pre><code class="language-sh">cast send 0x61a6eF395d217eD7C79e1B84880167a417796172 "mint(address _to, uint256 _amount)"  0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 1000  --rpc-url http://127.0.0.1:9545 --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80

</code></pre>
<h3 id="3-initiate-the-send-transaction-on-chain-901"><a class="header" href="#3-initiate-the-send-transaction-on-chain-901">3. Initiate the send transaction on chain 901</a></h3>
<p>Send the tokens from Chain 901 to Chain 902 using the following command:</p>
<pre><code class="language-sh">cast send 0x61a6eF395d217eD7C79e1B84880167a417796172 "sendERC20(address _to, uint256 _amount, uint256 _chainId)" 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 1000 902 --rpc-url http://127.0.0.1:9545 --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80
</code></pre>
<h3 id="4-wait-for-the-relayed-message-to-appear-on-chain-902"><a class="header" href="#4-wait-for-the-relayed-message-to-appear-on-chain-902">4. Wait for the relayed message to appear on chain 902</a></h3>
<p>In a few seconds, you should see the RelayedMessage on chain 902:</p>
<pre><code class="language-sh"># example
INFO [08-30|14:30:14.698] L2ToL2CrossChainMessenger#RelayedMessage sourceChainID=901 destinationChainID=902 nonce=0 sender=0x61a6eF395d217eD7C79e1B84880167a417796172 target=0x61a6eF395d217eD7C79e1B84880167a417796172
</code></pre>
<h3 id="5-check-the-balance-on-chain-902"><a class="header" href="#5-check-the-balance-on-chain-902">5. Check the balance on chain 902</a></h3>
<p>Verify that the balance of the L2NativeSuperchainERC20 on chain 902 has increased:</p>
<pre><code class="language-sh">cast balance --erc20 0x61a6eF395d217eD7C79e1B84880167a417796172 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 --rpc-url http://127.0.0.1:9546
</code></pre>
<p>With the steps above, you've now successfully completed both an L1 to L2 ETH bridge and an L2 to L2 interoperable SuperchainERC20 token transfer, all done locally using <code>supersim</code>. This approach simplifies multichain testing, allowing you to focus on development without the need for complex setups or relying on external testnets.</p>
<div style="break-before: page; page-break-before: always;"></div><!-- omit in toc -->
<h1 id="supersim-vanilla-mode"><a class="header" href="#supersim-vanilla-mode">supersim (vanilla mode)</a></h1>
<ul>
<li><a href="reference/supersim.html#overview">Overview</a></li>
<li><a href="reference/supersim.html#configuration">Configuration</a></li>
</ul>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>Start supersim in vanilla (non-forked) mode</p>
<pre><code class="language-sh">supersim
</code></pre>
<p>Vanilla mode will start 3 chains, with the OP Stack contracts &amp; periphery contracts already deployed.</p>
<ul>
<li>(1) L1 Chain
<ul>
<li>Chain 900</li>
</ul>
</li>
<li>(2) L2 Chains
<ul>
<li>Chain 901</li>
<li>Chain 902</li>
</ul>
</li>
</ul>
<p><strong>Example startup logs</strong></p>
<pre><code>Available Accounts
-----------------------
(0): 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
(1): 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
(2): 0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC
(3): 0x90F79bf6EB2c4f870365E785982E1f101E93b906
(4): 0x15d34AAf54267DB7D7c367839AAf71A00a2C6A65
(5): 0x9965507D1a55bcC2695C58ba16FB37d819B0A4dc
(6): 0x976EA74026E726554dB657fA54763abd0C3a0aa9
(7): 0x14dC79964da2C08b23698B3D3cc7Ca32193d9955
(8): 0x23618e81E3f5cdF7f54C3d65f7FBc0aBf5B21E8f
(9): 0xa0Ee7A142d267C1f36714E4a8F75612F20a79720

Private Keys
-----------------------
(0): 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80
(1): 0x59c6995e998f97a5a0044966f0945389dc9e86dae88c7a8412f4603b6b78690d
(2): 0x5de4111afa1a4b94908f83103eb1f1706367c2e68ca870fc3fb9a804cdab365a
(3): 0x7c852118294e51e653712a81e05800f419141751be58f605c371e15141b007a6
(4): 0x47e179ec197488593b187f80a00eb0da91f1b9d0b13f8733639f19c30a34926a
(5): 0x8b3a350cf5c34c9194ca85829a2df0ec3153be0318b5e2d3348e872092edffba
(6): 0x92db14e403b83dfe3df233f83dfa3a0d7096f21ca9b0d6d6b8d88b2b4ec1564e
(7): 0x4bbbf85ce3377467afe5d46f804f221813b2bb87f24d81f60f1fcdbf7cbf4356
(8): 0xdbda1821b80551c9d65939329250298aa3472ba22feea921c0cf5d620ea67b97
(9): 0x2a871d0798f97d79848a013d4936a73bf4cc922c825d33c1cf7073dff6d409c6

Orchestrator Config:
L1:
  Name: L1    Chain ID: 900    RPC: http://127.0.0.1:8545    LogPath: /var/folders/0w/ethers-phoenix/T/anvil-chain-900
L2:
  Name: OPChainA    Chain ID: 901    RPC: http://127.0.0.1:9545    LogPath: /var/folders/0w/ethers-phoenix/T/anvil-chain-901
  Name: OPChainB    Chain ID: 902    RPC: http://127.0.0.1:9546    LogPath: /var/folders/0w/ethers-phoenix/T/anvil-chain-902
</code></pre>
<h2 id="configuration"><a class="header" href="#configuration">Configuration</a></h2>
<pre><code>NAME:
   supersim - Superchain Multi-L2 Simulator

USAGE:
   supersim [global options] command [command options]

VERSION:
   untagged

DESCRIPTION:
   Local multichain optimism development environment

COMMANDS:
   fork     Locally fork a network in the superchain registry
   help, h  Shows a list of commands or help for one command

GLOBAL OPTIONS:

    --interop.autorelay                 (default: false)                   ($SUPERSIM_AUTORELAY)
          Automatically relay messages sent to the L2ToL2CrossDomainMessenger using
          account 0xa0Ee7A142d267C1f36714E4a8F75612F20a79720

    --l1.port value                     (default: 8545)                    ($SUPERSIM_L1_PORT)
          Listening port for the L1 instance. `0` binds to any available port

    --l2.starting.port value            (default: 9545)                    ($SUPERSIM_L2_STARTING_PORT)
          Starting port to increment from for L2 chains. `0` binds each chain to any
          available port

    --log.color                         (default: false)                   ($SUPERSIM_LOG_COLOR)
          Color the log output if in terminal mode

    --log.format value                  (default: text)                    ($SUPERSIM_LOG_FORMAT)
          Format the log output. Supported formats: 'text', 'terminal', 'logfmt', 'json',
          'json-pretty',

    --log.level value                   (default: INFO)                    ($SUPERSIM_LOG_LEVEL)
          The lowest log level that will be output

    --log.pid                           (default: false)                   ($SUPERSIM_LOG_PID)
          Show pid in the log

   MISC


    --help, -h                          (default: false)
          show help

    --version, -v                       (default: false)
          print the version
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><!-- omit in toc -->
<h1 id="supersim-fork-forked-mode"><a class="header" href="#supersim-fork-forked-mode">supersim fork (forked mode)</a></h1>
<ul>
<li><a href="reference/supersim-fork.html#overview">Overview</a></li>
<li><a href="reference/supersim-fork.html#configuration">Configuration</a></li>
<li><a href="reference/supersim-fork.html#notes">Notes</a>
<ul>
<li><a href="reference/supersim-fork.html#fork-height">Fork height</a></li>
<li><a href="reference/supersim-fork.html#interoperability-contracts">Interoperability contracts</a></li>
</ul>
</li>
</ul>
<h2 id="overview-1"><a class="header" href="#overview-1">Overview</a></h2>
<pre><code class="language-sh">supersim fork
</code></pre>
<p>The supersim fork command simplifies the process of forking multiple chains in the Superchain ecosystem simultaneously. It determines the appropriate block heights for each chain and launches both the L1 and L2 chains based on these values.</p>
<p>If you're relying on contracts already deployed on testnet / mainnet chains, you can use fork mode to simulate and interact with the state of the chain without needing to re-deploy or modify the contracts.</p>
<p>Locally fork any of the available chains in a superchain network of the <a href="https://github.com/ethereum-optimism/superchain-registry">superchain registry</a>, default <code>mainnet</code> versions.</p>
<p><strong>Example startup logs</strong></p>
<pre><code>Available Accounts
-----------------------
(0): 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
--- truncated for brevity ---

Private Keys
-----------------------
(0): 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80
--- truncated for brevity ---

Orchestrator Config:
L1:
  Name: mainnet    Chain ID: 1    RPC: http://127.0.0.1:8545    LogPath: /var/folders/0w/ethers-phoenix/T/anvil-chain-1-1521250718
L2:
  Name: op    Chain ID: 10    RPC: http://127.0.0.1:9545    LogPath: /var/folders/0w/ethers-phoenix/T/anvil-chain-10
  Name: base    Chain ID: 8453    RPC: http://127.0.0.1:9546    LogPath: /var/folders/0w/ethers-phoenix/T/anvil-chain-8453
  Name: zora    Chain ID: 7777777    RPC: http://127.0.0.1:9547    LogPath: /var/folders/0w/ethers-phoenix/T/anvil-chain-7777777
</code></pre>
<h2 id="configuration-1"><a class="header" href="#configuration-1">Configuration</a></h2>
<pre><code>NAME:
   supersim fork - Locally fork a network in the superchain registry

USAGE:
   supersim fork [command options]

OPTIONS:

          --l1.fork.height value              (default: 0)                       ($SUPERSIM_L1_FORK_HEIGHT)
                L1 height to fork the superchain (bounds L2 time). `0` for latest

          --chains value                                                         ($SUPERSIM_CHAINS)
                chains to fork in the superchain, mainnet options: [base, lyra, metal, mode, op,
                orderly, race, zora]. In order to replace the public rpc endpoint for a chain,
                specify the ($SUPERSIM_RPC_URL_&lt;CHAIN&gt;) env variable. i.e
                SUPERSIM_RPC_URL_OP=http://optimism-mainnet.infura.io/v3/&lt;API-KEY&gt;

          --network value                     (default: "mainnet")               ($SUPERSIM_NETWORK)
                superchain network. options: mainnet, sepolia, sepolia-dev-0. In order to
                replace the public rpc endpoint for the network, specify the
                ($SUPERSIM_RPC_URL_&lt;NETWORK&gt;) env variable. i.e
                SUPERSIM_RPC_URL_MAINNET=http://mainnet.infura.io/v3/&lt;API-KEY&gt;

          --interop.enabled                   (default: false)                   ($SUPERSIM_FORK_WITH_INTEROP)
                Enable interop in fork mode

          --l1.port value                     (default: 8545)                    ($SUPERSIM_L1_PORT)
                Listening port for the L1 instance. `0` binds to any available port

          --l2.starting.port value            (default: 9545)                    ($SUPERSIM_L2_STARTING_PORT)
                Starting port to increment from for L2 chains. `0` binds each chain to any
                available port

          --interop.autorelay                 (default: false)                   ($SUPERSIM_AUTORELAY)
                Automatically relay messages sent to the L2ToL2CrossDomainMessenger using
                account 0xa0Ee7A142d267C1f36714E4a8F75612F20a79720

          --aa.bundler                        (default: false)                   ($SUPERSIM_AA_BUNDLER)
                Run a ERC-4337 Bundler which sends transactions using account
                0x23618e81E3f5cdF7f54C3d65f7FBc0aBf5B21E8f

          --log.level value                   (default: INFO)                    ($SUPERSIM_LOG_LEVEL)
                The lowest log level that will be output

          --log.format value                  (default: text)                    ($SUPERSIM_LOG_FORMAT)
                Format the log output. Supported formats: 'text', 'terminal', 'logfmt', 'json',
                'json-pretty',

          --log.color                         (default: false)                   ($SUPERSIM_LOG_COLOR)
                Color the log output if in terminal mode

          --log.pid                           (default: false)                   ($SUPERSIM_LOG_PID)
                Show pid in the log

          --help, -h                          (default: false)
                show help
</code></pre>
<h2 id="notes"><a class="header" href="#notes">Notes</a></h2>
<h3 id="fork-height"><a class="header" href="#fork-height">Fork height</a></h3>
<p>The fork height is determined by L1 block height (default <code>latest</code>). This is then used to derive the corresponding L2 block to start from.</p>
<h3 id="interoperability-contracts"><a class="header" href="#interoperability-contracts">Interoperability contracts</a></h3>
<p>By default, interop contracts are not deployed on forked networks. To include them, run supersim with the <code>--interop.enabled</code> flag.</p>
<pre><code class="language-sh">supersim fork --chains=op,base,zora --interop.enabled
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><!-- omit in toc -->
<h1 id="included-contracts"><a class="header" href="#included-contracts">Included contracts</a></h1>
<p>The chain environment includes contracts already deployed to help replicate the Superchain environment. You can see an example of contract addresses for a L2 system <a href="chain-environment/contracts//docs/src/chain-environment/network-details/op-chain-a.html">here</a>.</p>
<ul>
<li><a href="chain-environment/contracts/index.html#op-stack-system-contracts-l1">OP Stack system contracts (L1)</a></li>
<li><a href="chain-environment/contracts/index.html#op-stack-l2-contracts-l2">OP Stack L2 contracts (L2)</a></li>
<li><a href="chain-environment/contracts/index.html#periphery-contracts-l2">Periphery contracts (L2)</a>
<ul>
<li><a href="chain-environment/contracts/index.html#l2nativesuperchainerc20">L2NativeSuperchainERC20</a>
<ul>
<li><a href="chain-environment/contracts/index.html#minting-new-tokens">Minting new tokens</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="op-stack-system-contracts-l1"><a class="header" href="#op-stack-system-contracts-l1">OP Stack system contracts (L1)</a></h2>
<p>These are the L1 contracts that are required for a rollup as part of the OP Stack protocol. Examples are the <a href="https://github.com/ethereum-optimism/optimism/blob/develop/packages/contracts-bedrock/src/L1/OptimismPortal.sol">OptimismPortal</a>, <a href="https://github.com/ethereum-optimism/optimism/blob/develop/packages/contracts-bedrock/src/L1/L1StandardBridge.sol">L1StandardBridge</a>, and <a href="https://github.com/ethereum-optimism/optimism/blob/develop/packages/contracts-bedrock/src/L1/L1CrossDomainMessenger.sol">L1CrossDomainMessenger</a>.</p>
<p>View examples of these contracts here the official <a href="https://docs.optimism.io/chain/addresses#ethereum-l1">OP docs</a> or the source code <a href="https://github.com/ethereum-optimism/optimism/tree/develop/packages/contracts-bedrock/src/L1">here in the Optimism monorepo</a></p>
<h2 id="op-stack-l2-contracts-l2"><a class="header" href="#op-stack-l2-contracts-l2">OP Stack L2 contracts (L2)</a></h2>
<p>The OP Stack system contracts on the L2 are included at the standard addresses by default.</p>
<ul>
<li><a href="https://specs.optimism.io/protocol/predeploys.html">Standard OP Stack predeploys (L2)</a></li>
<li><a href="https://specs.optimism.io/interop/predeploys.html">Interoperability predeploys (<em>experimental</em>) (L2)</a></li>
<li><a href="https://specs.optimism.io/protocol/preinstalls.html">OP Stack preinstalls (L2)</a></li>
</ul>
<h2 id="periphery-contracts-l2"><a class="header" href="#periphery-contracts-l2">Periphery contracts (L2)</a></h2>
<p>L2 chains running on <code>supersim</code> also includes some useful contracts for testing purposes that are not part of the OP Stack by default.</p>
<h3 id="l2nativesuperchainerc20"><a class="header" href="#l2nativesuperchainerc20">L2NativeSuperchainERC20</a></h3>
<p>A simple ERC20 that adheres to the SuperchainERC20 standard. It includes permissionless minting for easy testing.</p>
<p>Source: <a href="chain-environment/contracts//contracts/src/L2NativeSuperchainERC20.sol">L2NativeSuperchainERC20.sol</a></p>
<p>Deployed address: <code>0x61a6eF395d217eD7C79e1B84880167a417796172</code></p>
<h4 id="minting-new-tokens"><a class="header" href="#minting-new-tokens">Minting new tokens</a></h4>
<pre><code class="language-bash">cast send 0x61a6eF395d217eD7C79e1B84880167a417796172 "mint(address _to, uint256 _amount)" $RECIPIENT_ADDRESS 1ether  --rpc-url $L2_RPC_URL
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="network-details"><a class="header" href="#network-details">Network details</a></h1>
<p>By default, two OP Stack systems will be spun up in vanilla mode</p>
<ul>
<li>OPChainA (chainID 901)</li>
<li>OPChainB (chainID 902)</li>
</ul>
<p>Both "roll up" into a single L1 chain (chainID 900).</p>
<div style="break-before: page; page-break-before: always;"></div><!-- omit in toc -->
<h1 id="opchaina"><a class="header" href="#opchaina">OPChainA</a></h1>
<ul>
<li><a href="chain-environment/network-details/op-chain-a.html#network-details">Network details</a></li>
<li><a href="chain-environment/network-details/op-chain-a.html#contract-addresses">Contract addresses</a>
<ul>
<li><a href="chain-environment/network-details/op-chain-a.html#l1-contracts">L1 contracts</a></li>
<li><a href="chain-environment/network-details/op-chain-a.html#l2-contracts">L2 contracts</a></li>
</ul>
</li>
</ul>
<h2 id="network-details-1"><a class="header" href="#network-details-1">Network details</a></h2>
<div class="table-wrapper"><table><thead><tr><th><strong>Parameter</strong></th><th><strong>Value</strong></th></tr></thead><tbody>
<tr><td><strong>Name</strong></td><td>OPChainA</td></tr>
<tr><td><strong>Chain ID</strong></td><td>901</td></tr>
<tr><td><strong>RPC URL</strong></td><td><a href="http://127.0.0.1:9545">http://127.0.0.1:9545</a></td></tr>
</tbody></table>
</div>
<h2 id="contract-addresses"><a class="header" href="#contract-addresses">Contract addresses</a></h2>
<h3 id="l1-contracts"><a class="header" href="#l1-contracts">L1 contracts</a></h3>
<pre><code class="language-json">{
  "AddressManager": "0x78d21C9820A9135215202A9a8D6521483D4b75cD",
  "AnchorStateRegistry": "0x21799f09394c50220CCD95E7dAc1cdD774FC871a",
  "AnchorStateRegistryProxy": "0xa6F40d5770b3509aB40B2effa5cb544D29743ec7",
  "DelayedWETH": "0x49BBFf1629824A1e7993Ab5c17AFa45D24AB28c9",
  "DelayedWETHProxy": "0x309DA6B9a8fE16afD7D067528d358E55314bEa6b",
  "DisputeGameFactory": "0x20B168142354Cee65a32f6D8cf3033E592299765",
  "DisputeGameFactoryProxy": "0x444689B81D485bc58AB81aC02A95a937fAa152D7",
  "L1CrossDomainMessenger": "0x094e6508ba9d9bf1ce421fff3dE06aE56e67901b",
  "L1CrossDomainMessengerProxy": "0xe5bda89cd85cE0DfB80E053281cA070D65B738e6",
  "L1ERC721Bridge": "0x5C4F5e749A61a9503c4AAE8a9393e89609a0e804",
  "L1ERC721BridgeProxy": "0x018dC24a6617c47cAa00C3fA25097214B2D4F447",
  "L1StandardBridge": "0xb7900B27Be8f0E0fF65d1C3A4671e1220437dd2b",
  "L1StandardBridgeProxy": "0xa01ae68902e205B420FD164435F299E07b0C778b",
  "L2OutputOracle": "0x19652082F846171168Daf378C4fD3ee85a0D4A60",
  "L2OutputOracleProxy": "0x6cE0530E823e23be85D8e151FB023605eB4F6d43",
  "Mips": "0xB3A0348310a0ff78E5FbDB7f14BB7d3e02d40773",
  "OptimismMintableERC20Factory": "0x39Aea2Dd53f2d01c15877aCc2791af6BDD7aD567",
  "OptimismMintableERC20FactoryProxy": "0x15c855966C196Be3a8ca747E8A8Bf40928d4741f",
  "OptimismPortal": "0xb7461Fb347f68f9717e6fD12C8407dEcee063bdc",
  "OptimismPortal2": "0xfcbb237388CaF5b08175C9927a37aB6450acd535",
  "OptimismPortalProxy": "0xF5fe61a258CeBb54CCe428F76cdeD04Cbc12F53d",
  "PreimageOracle": "0x3bd7E801E51d48c5d94Ea68e8B801DFFC275De75",
  "ProtocolVersions": "0xfbfD64a6C0257F613feFCe050Aa30ecC3E3d7C3F",
  "ProtocolVersionsProxy": "0x6dA4f6489039d9f4F3144954DDF5bb2F4986e90b",
  "ProxyAdmin": "0xe32a4D31ffD5596542DAc8239a1DE3Fff9d63475",
  "SafeProxyFactory": "0x4a05c09875DE2DD5B81Bc01dd46eD4699b181bfA",
  "SafeSingleton": "0x99A395CE6d6b37CaaCBad64fB42d556b6CA73a48",
  "SuperchainConfig": "0x068E44eB31e111028c41598E4535be7468674D0A",
  "SuperchainConfigProxy": "0x7E6c6ebCF109fa23277b86bdA39738035C21BB86",
  "SystemConfig": "0x6167B477F8d9138aa509f54b2800443857e28c0f",
  "SystemConfigProxy": "0xf32919Ed2490b56EaD65E72749894aE4C9523320",
  "SystemOwnerSafe": "0xc052b7316C87390E555aF97D42bCd5FB6d5eEFDa"
}
</code></pre>
<h3 id="l2-contracts"><a class="header" href="#l2-contracts">L2 contracts</a></h3>
<pre><code class="language-json">{
  // OP Stack predeploys
  "L2ToL1MessagePasser": "0x4200000000000000000000000000000000000016",
  "L2CrossDomainMessenger": "0x4200000000000000000000000000000000000007",
  "L2StandardBridge": "0x4200000000000000000000000000000000000010",
  "L2ERC721Bridge": "0x4200000000000000000000000000000000000014",
  "SequencerFeeVault": "0x4200000000000000000000000000000000000011",
  "OptimismMintableERC20Factory": "0x4200000000000000000000000000000000000012",
  "OptimismMintableERC721Factory": "0x4200000000000000000000000000000000000017",
  "L1BlockInterop": "0x4200000000000000000000000000000000000015",
  "GasPriceOracle": "0x420000000000000000000000000000000000000F",
  "ProxyAdmin": "0x4200000000000000000000000000000000000018",
  "BaseFeeVault": "0x4200000000000000000000000000000000000019",
  "L1FeeVault": "0x420000000000000000000000000000000000001A",
  "GovernanceToken": "0x4200000000000000000000000000000000000042",
  "SchemaRegistry": "0x4200000000000000000000000000000000000020",
  "EAS": "0x4200000000000000000000000000000000000021",
  "CrossL2Inbox": "0x4200000000000000000000000000000000000022",
  "L2ToL2CrossDomainMessenger": "0x4200000000000000000000000000000000000023",

  // Periphery
  "L2NativeSuperchainERC20": "0x61a6eF395d217eD7C79e1B84880167a417796172"
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><!-- omit in toc -->
<h1 id="opchainb"><a class="header" href="#opchainb">OPChainB</a></h1>
<ul>
<li><a href="chain-environment/network-details/op-chain-b.html#network-details">Network details</a></li>
<li><a href="chain-environment/network-details/op-chain-b.html#contract-addresses">Contract addresses</a>
<ul>
<li><a href="chain-environment/network-details/op-chain-b.html#l1-contracts">L1 contracts</a></li>
<li><a href="chain-environment/network-details/op-chain-b.html#l2-contracts">L2 contracts</a></li>
</ul>
</li>
</ul>
<h2 id="network-details-2"><a class="header" href="#network-details-2">Network details</a></h2>
<div class="table-wrapper"><table><thead><tr><th><strong>Parameter</strong></th><th><strong>Value</strong></th></tr></thead><tbody>
<tr><td><strong>Name</strong></td><td>OPChainB</td></tr>
<tr><td><strong>Chain ID</strong></td><td>902</td></tr>
<tr><td><strong>RPC URL</strong></td><td><a href="http://127.0.0.1:9546">http://127.0.0.1:9546</a></td></tr>
</tbody></table>
</div>
<h2 id="contract-addresses-1"><a class="header" href="#contract-addresses-1">Contract addresses</a></h2>
<h3 id="l1-contracts-1"><a class="header" href="#l1-contracts-1">L1 contracts</a></h3>
<pre><code class="language-json">{
  "AddressManager": "0xafB51A0f73C8409AeA1207DF7f39885c927BeA46",
  "AnchorStateRegistry": "0x05493149c84A71063f7948127bb931f8377F779C",
  "AnchorStateRegistryProxy": "0xfd0269a716A59fF125Bd7eb65Cd3427C8555bab7",
  "DelayedWETH": "0x49BBFf1629824A1e7993Ab5c17AFa45D24AB28c9",
  "DelayedWETHProxy": "0xA63353128502269b4A4A4c2677fE316cd9ad4397",
  "DisputeGameFactory": "0x20B168142354Cee65a32f6D8cf3033E592299765",
  "DisputeGameFactoryProxy": "0x5F416fEb15c8B382d338FDBDb7D44967ca2b59BC",
  "L1CrossDomainMessenger": "0x094e6508ba9d9bf1ce421fff3dE06aE56e67901b",
  "L1CrossDomainMessengerProxy": "0xCB9768921831677Ae15cE4B64A10B94F49cD88E2",
  "L1ERC721Bridge": "0x5C4F5e749A61a9503c4AAE8a9393e89609a0e804",
  "L1ERC721BridgeProxy": "0xDCE41E6C0901586EE27Eac329EBD4b5fe5A7170d",
  "L1StandardBridge": "0xb7900B27Be8f0E0fF65d1C3A4671e1220437dd2b",
  "L1StandardBridgeProxy": "0x2D8543c236a4d626f54B51Fa8bc229a257C5143E",
  "L2OutputOracle": "0x19652082F846171168Daf378C4fD3ee85a0D4A60",
  "L2OutputOracleProxy": "0x006Af3fB62c4BE4fB0393995d364BbFe6b0F3CB2",
  "Mips": "0xB3A0348310a0ff78E5FbDB7f14BB7d3e02d40773",
  "OptimismMintableERC20Factory": "0x39Aea2Dd53f2d01c15877aCc2791af6BDD7aD567",
  "OptimismMintableERC20FactoryProxy": "0x1A2A942d891e525D1Ab192578a378980729fD585",
  "OptimismPortal": "0xb7461Fb347f68f9717e6fD12C8407dEcee063bdc",
  "OptimismPortal2": "0xfcbb237388CaF5b08175C9927a37aB6450acd535",
  "OptimismPortalProxy": "0xdfC9DEAbEEbDaa7620C71e2E76AEda32919DE5f2",
  "PreimageOracle": "0x3bd7E801E51d48c5d94Ea68e8B801DFFC275De75",
  "ProtocolVersions": "0xfbfD64a6C0257F613feFCe050Aa30ecC3E3d7C3F",
  "ProtocolVersionsProxy": "0xE139cB0CDa5EF722870068ea331d0989776A7aDf",
  "ProxyAdmin": "0xff5E6C2Af859f70B875BA59B958BEde60E36bf69",
  "SafeProxyFactory": "0xb68f3B057fE3c6CdDF9DB35837Ea769FCc81978a",
  "SafeSingleton": "0xeeB44D84d505AbD958d032e90704c56443eB3ED0",
  "SuperchainConfig": "0x068E44eB31e111028c41598E4535be7468674D0A",
  "SuperchainConfigProxy": "0x2ED4AA34573c36bF3856e597501aEf9d9Dc1687C",
  "SystemConfig": "0x6167B477F8d9138aa509f54b2800443857e28c0f",
  "SystemConfigProxy": "0x2Db03FE998D7c20E4B65afD1f50f04Ec4BfAb694",
  "SystemOwnerSafe": "0xBF3830711B7c559042453B7546dB4736eFB4245e"
}
</code></pre>
<h3 id="l2-contracts-1"><a class="header" href="#l2-contracts-1">L2 contracts</a></h3>
<pre><code class="language-json">{
  // OP Stack predeploys
  "L2ToL1MessagePasser": "0x4200000000000000000000000000000000000016",
  "L2CrossDomainMessenger": "0x4200000000000000000000000000000000000007",
  "L2StandardBridge": "0x4200000000000000000000000000000000000010",
  "L2ERC721Bridge": "0x4200000000000000000000000000000000000014",
  "SequencerFeeVault": "0x4200000000000000000000000000000000000011",
  "OptimismMintableERC20Factory": "0x4200000000000000000000000000000000000012",
  "OptimismMintableERC721Factory": "0x4200000000000000000000000000000000000017",
  "L1BlockInterop": "0x4200000000000000000000000000000000000015",
  "GasPriceOracle": "0x420000000000000000000000000000000000000F",
  "ProxyAdmin": "0x4200000000000000000000000000000000000018",
  "BaseFeeVault": "0x4200000000000000000000000000000000000019",
  "L1FeeVault": "0x420000000000000000000000000000000000001A",
  "GovernanceToken": "0x4200000000000000000000000000000000000042",
  "SchemaRegistry": "0x4200000000000000000000000000000000000020",
  "EAS": "0x4200000000000000000000000000000000000021",
  "CrossL2Inbox": "0x4200000000000000000000000000000000000022",
  "L2ToL2CrossDomainMessenger": "0x4200000000000000000000000000000000000023",

  // Periphery
  "L2NativeSuperchainERC20": "0x61a6eF395d217eD7C79e1B84880167a417796172"
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="deposit-transactions"><a class="header" href="#deposit-transactions">Deposit transactions</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="interoperability"><a class="header" href="#interoperability">Interoperability</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="fetching-identifiers-for-interop-messages"><a class="header" href="#fetching-identifiers-for-interop-messages">Fetching identifiers for interop messages</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="calling-contracts-on-destination-chain"><a class="header" href="#calling-contracts-on-destination-chain">Calling contracts on destination chain</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bridging-superchainweth"><a class="header" href="#bridging-superchainweth">Bridging SuperchainWETH</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cross-chain-tic-tac-toe"><a class="header" href="#cross-chain-tic-tac-toe">Cross-chain tic-tac-toe</a></h1>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
